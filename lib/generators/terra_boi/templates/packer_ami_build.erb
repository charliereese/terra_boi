#!/bin/bash

# Update to the latest current version of packages
sudo apt-get update
sudo apt -y install docker.io
docker --version

# Set DB and DockerHub usernames
export DB_PASSWORD=$DB_PASSWORD
export DOCKERHUB_USERNAME=$DOCKERHUB_USERNAME

# # Start the Docker service
sudo service docker start
sudo usermod -aG docker ubuntu

# # Automatically start Docker service when the system boots, i.e. when the EC2 instance created from this AMI is launched or rebooted
sudo systemctl enable docker

# Log in
sudo docker login --username $DOCKERHUB_USERNAME -p $DOCKERHUB_ACCESS_TOKEN

# Pull the container:
sudo docker pull $DOCKERHUB_USERNAME/<%= application_name %>:latest